<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portal Wi‑Fi – Deputado | Galeria de Vídeos</title>
  <meta name="description" content="Landing do Wi‑Fi grátis com galeria de vídeos do Deputado, painel de feitos e gráfico de resultados. Botão libera a internet após visualização.">
  <style>
    :root {
      --bg: #0f172a;
      --card: #0b1224;
      --muted: #94a3b8;
      --text: #e2e8f0;
      --brand: #22d3ee;
      --brand-2: #60a5fa;
      --accent: #f59e0b;
      --ok: #22c55e;
      --danger: #ef4444;
      --shadow: 0 20px 40px rgba(0,0,0,.35);
      --radius-xl: 18px;
      --radius-2xl: 24px;
      --video-width: 100%; /* Controle do tamanho do vídeo */
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial;
      color: var(--text);
      background:
        radial-gradient(1200px 600px at 10% -20%, rgba(96,165,250,.15), transparent 60%),
        radial-gradient(1200px 600px at 110% 20%, rgba(34,211,238,.18), transparent 60%),
        linear-gradient(180deg, #0b1022 0%, #0f172a 60%);
    }
    a { color: inherit }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px; }

    header.hero { display: grid; gap: 18px; align-items: center; grid-template-columns: 1.2fr .8fr; }
    @media (max-width: 960px){ header.hero { grid-template-columns: 1fr; } }
    .badge { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; background: rgba(96,165,250,.15); color: #cfe3ff; border: 1px solid rgba(96,165,250,.25); font-weight: 600; font-size: 12px }
    h1 { font-size: clamp(28px, 3.6vw, 44px); line-height: 1.1; margin: 6px 0 4px; }
    .lead { color: var(--muted); font-size: clamp(14px, 1.8vw, 18px); max-width: 60ch }

    .card { background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02)); border: 1px solid rgba(255,255,255,.08); border-radius: var(--radius-2xl); box-shadow: var(--shadow); overflow: hidden }

    .grid { display: grid; gap: 16px; grid-template-columns: repeat(12, 1fr) }
    .col-7 { grid-column: span 7 }
    .col-5 { grid-column: span 5 }
    @media (max-width: 960px){ .col-7,.col-5 { grid-column: 1 / -1 } }

    /* Player principal - AQUI CONTROLAMOS O TAMANHO */
    .media-container {
      width: var(--video-width);
      margin: 0 auto;
      transition: width 0.3s ease;
    }
    .media { 
      position: relative; 
      aspect-ratio: 16/9; 
      background: #050a1a; 
      border-radius: var(--radius-2xl); 
      overflow: hidden; 
      border: 1px solid rgba(255,255,255,.08);
    }
    video { width: 100%; height: 100%; object-fit: cover; display: block }
    .overlay { position: absolute; inset: 0; background: linear-gradient(180deg, rgba(5,10,26,.0), rgba(5,10,26,.35)); pointer-events: none; }
    .controls { position: absolute; inset: auto 16px 14px 16px; display: flex; gap: 10px; align-items: center; justify-content: space-between; }
    .playbtn { appearance: none; border: none; border-radius: 999px; padding: 14px 18px; font-weight: 800; background: linear-gradient(135deg, var(--brand), var(--brand-2)); color: #0b0f1f; box-shadow: 0 10px 24px rgba(34,211,238,.35); cursor: pointer }
    .mutebtn { appearance: none; border: 1px solid rgba(255,255,255,.25); background: rgba(255,255,255,.06); color: var(--text); border-radius: 12px; padding: 10px 12px; cursor: pointer }

    .progress { height: 6px; background: rgba(255,255,255,.07); border-radius: 999px; overflow: hidden; position: relative; margin-top: 8px }
    .progress > span { position: absolute; inset: 0 auto 0 0; width: 0%; background: linear-gradient(90deg, var(--brand), var(--accent)); transition: width .2s ease; }

    /* Galeria (playlist) */
    .gallery { display: grid; grid-auto-flow: column; grid-auto-columns: minmax(180px, 1fr); gap: 12px; overflow-x: auto; padding: 12px 4px; }
    .thumb { background: rgba(255,255,255,.05); border: 1px solid rgba(255,255,255,.08); border-radius: 14px; padding: 10px; display: grid; grid-template-rows: 110px auto; gap: 8px; cursor: pointer }
    .thumb canvas { width: 100%; height: 110px; border-radius: 10px; display: block; background: #0a0f20 }
    .thumb .meta { display: grid; gap: 4px }
    .thumb .title { font-weight: 700; font-size: 13px }
    .thumb .desc  { color: var(--muted); font-size: 12px }
    .thumb.active { outline: 2px solid var(--brand); box-shadow: 0 0 0 4px rgba(34,211,238,.15) inset }

    /* Feitos */
    .feitos { display: grid; gap: 14px; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); margin-top: 10px }
    .feito { background: rgba(255,255,255,.03); border: 1px solid rgba(255,255,255,.08); border-radius: 16px; padding: 14px; display: grid; gap: 8px }
    .feito .tit { font-weight: 700 }
    .feito .ico { font-size: 22px }
    .feito .desc { color: var(--muted); font-size: 13px }

    /* Gráfico */
    .chart-card { padding: 16px }
    canvas.chart { width: 100%; height: 260px; display: block; }

    /* Gate */
    .gate { display: grid; gap: 10px; align-items: center; grid-template-columns: 1fr auto }
    @media (max-width: 720px){ .gate { grid-template-columns: 1fr } }
    .agree { display: flex; align-items: start; gap: 10px; color: var(--muted); font-size: 14px }
    button.cta { appearance: none; border: none; border-radius: 14px; padding: 14px 18px; font-weight: 800; letter-spacing: .3px; background: linear-gradient(135deg, var(--brand), var(--brand-2)); color: #0b0f1f; cursor: not-allowed; opacity: .5; box-shadow: 0 14px 30px rgba(96,165,250,.35) }
    button.cta.enabled { cursor: pointer; opacity: 1 }
    .hint { color: var(--muted); font-size: 13px }
    .footer { color: var(--muted); font-size: 12px; text-align: center; margin-top: 12px }
    
    /* Novo estilo para termos ocultos inicialmente */
    .terms-hidden { display: none; }
    
    /* Uploader de vídeos (apenas para desenvolvimento local) */
    .upload-section { margin-top: 24px; padding: 16px; background: rgba(255,255,255,0.03); border-radius: 16px; border: 1px dashed rgba(255,255,255,0.1); }
    .upload-section h3 { margin-top: 0; }
    .upload-note { font-size: 13px; color: var(--muted); margin-top: 8px; }
    
    /* Mensagem de erro */
    .error-message { color: var(--danger); background: rgba(239,68,68,0.1); padding: 10px; border-radius: 8px; margin-top: 10px; }
    .error-message ul { margin: 8px 0; padding-left: 20px; }
    
    /* Loader */
    .loader { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: var(--brand); animation: spin 1s ease-in-out infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    /* Placeholder para vídeos */
    .video-placeholder { 
      width: 100%; 
      height: 100%; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      background: linear-gradient(135deg, #1e293b, #0f172a);
      color: var(--muted);
      font-size: 14px;
      text-align: center;
      padding: 20px;
    }
    
    /* Controles de tamanho do vídeo */
    .size-controls {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 10px 0;
    }
    .size-btn {
      padding: 8px 12px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .size-btn:hover {
      background: rgba(255,255,255,0.1);
    }
    .size-btn.active {
      background: var(--brand);
      color: #0b0f1f;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header class="hero">
      <div>
        <span class="badge">Wi‑Fi Social • Portal de Boas‑vindas</span>
        <h1>Conheça os <span style="background: linear-gradient(90deg, var(--brand), var(--accent)); -webkit-background-clip: text; background-clip: text; color: transparent;">resultados</span> do Deputado</h1>
        <p class="lead">Antes de liberar a internet grátis, assista a um vídeo da galeria com realizações e veja os dados de impacto por área. Transparência em tempo real.</p>
      </div>
      <div></div>
    </header>

   

    <section class="grid" style="margin-top: 18px;">
      <!-- Coluna Vídeo + Galeria -->
      <div class="col-7" style="display:grid; gap:12px;">
        <div class="media-container">
          <div class="media card" id="mediaCard" aria-label="Vídeo do Deputado">
            <video id="video" preload="metadata" playsinline controlslist="nodownload noplaybackrate" disablepictureinpicture poster="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=">
              Seu navegador não suporta vídeos HTML5.
            </video>
            <div class="overlay"></div>
            <div class="controls">
              <button class="playbtn" id="playBtn" aria-label="Reproduzir vídeo">▶ Assistir vídeo</button>
              <button class="mutebtn" id="muteBtn" aria-label="Ativar/Desativar som">🔈 Som</button>
            </div>
          </div>
        </div>
        <div class="progress" aria-label="Progresso para liberar Wi‑Fi" title="Progresso para liberar Wi‑Fi">
          <span id="progressBar"></span>
        </div>
        <small class="hint" id="hint">Assista <b id="needSecs">15</b>s (somando qualquer vídeo da galeria) para liberar o Wi‑Fi. Tempo assistido: <b id="watched">0</b>s.</small>

        <div class="card" style="padding: 12px;">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin: 4px 6px 8px;">
            <h3 style="margin:0;">Galeria de Vídeos</h3>
            <span class="badge">Arraste para o lado</span>
          </div>
          <div class="gallery" id="gallery"></div>
        </div>
      </div>

      <!-- Coluna Painel (Feitos + Gráfico) -->
      <div class="col-5" style="display: grid; gap: 16px;">
        <div class="card" style="padding: 16px;">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
            <h3 style="margin: 0;">Feitos em Destaque</h3>
            <span class="badge">Prestação de contas</span>
          </div>
          <div class="feitos" id="feitos"></div>
        </div>
        <div class="card chart-card">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:10px;">
            <h3 style="margin: 0;">Investimentos por Área</h3>
            <span class="badge">Dados de exemplo</span>
          </div>
          <canvas id="chart" class="chart" width="600" height="260" aria-label="Gráfico de barras"></canvas>
        </div>
      </div>
    </section>

    <section class="card terms-hidden" id="termsSection" style="margin-top: 18px; padding: 16px;">
      <div class="gate">
        <label class="agree">
          <input type="checkbox" id="terms" />
          <span>
            Li e concordo com os <a href="#" onclick="alert('Exemplo de termos. Substitua pelo documento oficial.'); return false;">termos de uso</a> e autorizo o uso dos meus dados de conexão conforme a LGPD.
          </span>
        </label>
        <button class="cta" id="connectBtn" disabled>🔓 Liberar Wi‑Fi</button>
      </div>
      <div class="footer">Este é um protótipo estático. Integre o botão "Liberar Wi‑Fi" ao seu portal cativo (roteador/controlador).</div>
    </section>
    
    <!-- Seção de upload (apenas para desenvolvimento local) -->
    <section class="upload-section card" id="uploadSection">
      <h3>🔧 Configuração de Vídeos (Desenvolvimento)</h3>
      <div class="error-message">
        <strong>⚠️ IMPORTANTE: Para vídeos locais, você precisa usar um servidor web!</strong>
        <p>Siga estes passos:</p>
        <ol>
          <li><strong>Abra o terminal/command prompt</strong> nesta pasta</li>
          <li><strong>Execute um destes comandos</strong>:
            <ul>
              <li>Python: <code>python -m http.server 8000</code></li>
              <li>Node.js: <code>npx serve</code></li>
              <li>PHP: <code>php -S localhost:8000</code></li>
            </ul>
          </li>
          <li><strong>Acesse</strong> o endereço mostrado (ex: http://localhost:8000)</li>
        </ol>
        <p>Seus vídeos devem estar na pasta <strong>videos/</strong> com os nomes:
          <strong>Ribeiro1.mp4</strong>, <strong>Ribeiro2.mp4</strong>, <strong>Ribeiro3.mp4</strong>, <strong>Ribeiro4.mp4</strong>
        </p>
      </div>
    </section>
  </div>

  <script>
    // =========================
    // CONFIGURAÇÕES
    // =========================
    const CONFIG = {
      requiredWatchSeconds: 15,
      minTimeOnPageSeconds: 30,
      portalRedirectUrl: "http://liberar.wifi/continuar",
      // URLs de vídeos - primeiro tenta os locais, depois fallback para online
      videos: [
        { 
          src: "videos/Ribeiro1.mp4", 
          onlineSrc: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4",
          title: "Saúde em 2024", 
          desc: "Ampliação de atendimentos e novas ambulâncias." 
        },
        { 
          src: "videos/Ribeiro2.mp4", 
          onlineSrc: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4",
          title: "Educação que Transforma", 
          desc: "Bolsas, reformas e tecnologia nas escolas." 
        },
        { 
          src: "videos/Ribeiro3.mp4", 
          onlineSrc: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",
          title: "Infraestrutura e Mobilidade", 
          desc: "Pavimentação, drenagem e acessibilidade." 
        },
        { 
          src: "videos/Ribeiro4.mp4", 
          onlineSrc: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/SubaruOutbackOnStreetAndDirt.mp4",
          title: "Segurança Pública", 
          desc: "Novas viaturas e equipamentos para a polícia." 
        }
      ],
      feitos: [
        { ico: "🏥", tit: "Nova UPA no bairro X", desc: "Atendimento 24h para 120 mil moradores." },
        { ico: "🏫", tit: "200 bolsas de estudo", desc: "Programa de inclusão para jovens de baixa renda." },
        { ico: "🚧", tit: "Pavimentação de ruas", desc: "18 km de asfalto com drenagem e acessibilidade." },
        { ico: "👮", tit: "Viaturas e câmeras", desc: "+15 viaturas e 120 câmeras de monitoramento." },
        { ico: "💼", tit: "Feira do Emprego", desc: "2.100 vagas conectadas em 1 ano." },
      ],
      chart: {
        labels: ["Saúde", "Educação", "Infraestrutura", "Segurança", "Emprego"],
        values: [38, 24, 22, 9, 7]
      }
    };

    // ===============
    // Estado
    // ===============
    let watchedSecondsSet = new Set();
    let pageStart = Date.now();
    let unlockedByVideo = false;
    let unlockedByTimeFallback = false;
    let videoErrors = 0;
    let usingOnlineVideos = false;

    // ==========
    // Elementos
    // ==========
    const video = document.getElementById('video');
    const playBtn = document.getElementById('playBtn');
    const muteBtn = document.getElementById('muteBtn');
    const progressBar = document.getElementById('progressBar');
    const needSecsEl = document.getElementById('needSecs');
    const watchedEl = document.getElementById('watched');
    const terms = document.getElementById('terms');
    const connectBtn = document.getElementById('connectBtn');
    const feitosEl = document.getElementById('feitos');
    const galleryEl = document.getElementById('gallery');
    const termsSection = document.getElementById('termsSection');
    const uploadSection = document.getElementById('uploadSection');
    const sizeButtons = document.querySelectorAll('.size-btn');

    needSecsEl.textContent = CONFIG.requiredWatchSeconds;

    // Controles de tamanho do vídeo
    sizeButtons.forEach(button => {
      button.addEventListener('click', () => {
        const size = button.getAttribute('data-size');
        document.documentElement.style.setProperty('--video-width', size);
        
        // Atualiza a classe ativa
        sizeButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
      });
    });

    // Render dos feitos
    for (const f of CONFIG.feitos) {
      const card = document.createElement('div');
      card.className = 'feito';
      card.innerHTML = `<div class="ico">${f.ico}</div>
                        <div class="tit">${f.tit}</div>
                        <div class="desc">${f.desc}</div>`;
      feitosEl.appendChild(card);
    }

    // Função para testar se um vídeo está acessível
    function testVideoAccess(url, callback) {
      const xhr = new XMLHttpRequest();
      xhr.open('HEAD', url);
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
          callback(xhr.status === 200 || xhr.status === 0);
        }
      };
      xhr.onerror = function() {
        callback(false);
      };
      xhr.send();
    }

    // Galeria (thumbnails gerados com frame do próprio vídeo via canvas)
    function buildGallery(){
      galleryEl.innerHTML = '';
      CONFIG.videos.forEach((v, idx) => {
        const t = document.createElement('div');
        t.className = 'thumb';
        t.innerHTML = `<canvas></canvas>
                       <div class="meta">
                         <div class="title">${v.title || 'Vídeo ' + (idx+1)}</div>
                         <div class="desc">${v.desc || ''}</div>
                       </div>`;
        t.addEventListener('click', () => selectVideo(idx));
        galleryEl.appendChild(t);

        // Testa primeiro o vídeo local, depois fallback para online
        testVideoAccess(v.src, (isAccessible) => {
          if (isAccessible) {
            generateThumb(v.src, t.querySelector('canvas'), idx);
          } else {
            usingOnlineVideos = true;
            generateThumb(v.onlineSrc, t.querySelector('canvas'), idx);
          }
        });
      });
    }

    function generateThumb(src, canvas, index){
      const v = document.createElement('video');
      v.src = src; 
      v.preload = 'metadata'; 
      v.muted = true;
      v.crossOrigin = 'anonymous';
      
      v.addEventListener('loadeddata', () => {
        try {
          const cw = canvas.clientWidth || 180, ch = canvas.clientHeight || 110;
          canvas.width = cw; canvas.height = ch;
          const ctx = canvas.getContext('2d');
          ctx.fillStyle = '#0a0f20'; ctx.fillRect(0,0,cw,ch);
          
          // Tenta definir um ponto específico para a miniatura
          v.currentTime = Math.min(v.duration || 10, 10);
          
          setTimeout(() => {
            const aspect = v.videoWidth / v.videoHeight || (16/9);
            let w = cw, h = Math.round(cw / aspect);
            if (h > ch) { h = ch; w = Math.round(h * aspect); }
            const x = (cw - w)/2, y = (ch - h)/2;
            ctx.drawImage(v, x, y, w, h);
            
            // overlay play
            ctx.globalAlpha = 0.85; 
            ctx.fillStyle = 'rgba(0,0,0,0.35)'; 
            ctx.fillRect(0,0,cw,ch); 
            ctx.globalAlpha = 1;
            ctx.beginPath(); 
            ctx.moveTo(cw/2 - 10, ch/2 - 14); 
            ctx.lineTo(cw/2 + 16, ch/2); 
            ctx.lineTo(cw/2 - 10, ch/2 + 14); 
            ctx.closePath(); 
            ctx.fillStyle = '#fff'; 
            ctx.fill();
          }, 500);
        } catch(e){
          console.error("Erro ao gerar miniatura:", e);
          drawFallbackThumb(canvas, "Prévia indisponível");
        }
      });
      
      v.addEventListener('error', (e) => {
        console.error("Erro ao carregar vídeo para miniatura:", src, e);
        videoErrors++;
        drawFallbackThumb(canvas, "Vídeo não carregado");
      });
    }

    function drawFallbackThumb(canvas, text) {
      const cw = canvas.clientWidth || 180, ch = canvas.clientHeight || 110;
      canvas.width = cw; canvas.height = ch;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#0a0f20'; 
      ctx.fillRect(0,0,cw,ch);
      ctx.font = '12px sans-serif'; 
      ctx.fillStyle = '#94a3b8'; 
      ctx.textAlign = 'center';
      ctx.fillText(text, cw/2, ch/2);
    }

    // Seleciona vídeo da galeria
    let currentIndex = 0;
    function selectVideo(index){
      currentIndex = index;
      // atualiza destaque na galeria
      [...galleryEl.children].forEach((el, i) => el.classList.toggle('active', i === index));
      
      // Testa primeiro o vídeo local, depois fallback para online
      testVideoAccess(CONFIG.videos[index].src, (isAccessible) => {
        if (isAccessible) {
          video.src = CONFIG.videos[index].src;
        } else {
          video.src = CONFIG.videos[index].onlineSrc;
          usingOnlineVideos = true;
        }
        video.load();
        video.currentTime = 0;
        playBtn.textContent = '▶ Assistir vídeo';
        video.pause();
      });
    }

    // Controles de vídeo
    playBtn.addEventListener('click', async () => {
      try {
        if (video.paused) { 
          await video.play(); 
          playBtn.textContent = '⏸ Pausar'; 
        } else { 
          video.pause(); 
          playBtn.textContent = '▶ Assistir vídeo'; 
        }
      } catch (e) { 
        console.error("Erro ao reproduzir vídeo:", e);
        alert('Erro ao reproduzir o vídeo. Verifique se está usando um servidor local.'); 
      }
    });
    
    muteBtn.addEventListener('click', () => { 
      video.muted = !video.muted; 
      muteBtn.textContent = video.muted ? '🔇 Sem som' : '🔈 Som'; 
    });
    
    video.addEventListener('click', () => { 
      if (video.paused){ 
        video.play().then(() => {
          playBtn.textContent = '⏸ Pausar'; 
        }).catch(e => {
          console.error("Erro ao reproduzir vídeo:", e);
        });
      } else { 
        video.pause(); 
        playBtn.textContent = '▶ Assistir vídeo'; 
      }
    });

    // Contabiliza segundos únicos assistidos
    video.addEventListener('timeupdate', () => {
      const sec = Math.floor(video.currentTime);
      watchedSecondsSet.add(`${currentIndex}:${sec}`);
      const watched = Math.min(watchedSecondsSet.size, CONFIG.requiredWatchSeconds);
      const pct = Math.floor((watched / CONFIG.requiredWatchSeconds) * 100);
      progressBar.style.width = pct + '%';
      watchedEl.textContent = watched.toString();
      
      // Mostra a seção de termos quando atingir 15 segundos
      if (watched >= CONFIG.requiredWatchSeconds) { 
        unlockedByVideo = true; 
        termsSection.classList.remove('terms-hidden');
        maybeEnableConnect(); 
      }
    });

    // Fallback: tempo total na página
    setInterval(() => {
      const elapsed = Math.floor((Date.now() - pageStart)/1000);
      if (elapsed >= CONFIG.minTimeOnPageSeconds) { 
        unlockedByTimeFallback = true; 
        termsSection.classList.remove('terms-hidden');
        maybeEnableConnect(); 
      }
    }, 1000);

    function maybeEnableConnect(){
      const termsOk = terms.checked;
      const unlocked = (unlockedByVideo || unlockedByTimeFallback) && termsOk;
      connectBtn.disabled = !unlocked;
      connectBtn.classList.toggle('enabled', unlocked);
      if (unlocked) connectBtn.style.cursor = 'pointer';
    }
    terms.addEventListener('change', maybeEnableConnect);

    connectBtn.addEventListener('click', () => {
      if (connectBtn.disabled) return;
      window.location.href = CONFIG.portalRedirectUrl;
    });

    // =====================
    // Gráfico em Canvas puro
    // =====================
    const ctx = document.getElementById('chart').getContext('2d');
    drawBarChart(ctx, CONFIG.chart.labels, CONFIG.chart.values);

    function drawBarChart(ctx, labels, values){
      const W = ctx.canvas.width, H = ctx.canvas.height;
      const padL = 50, padR = 14, padT = 20, padB = 40;
      ctx.clearRect(0,0,W,H);
      const grad = ctx.createLinearGradient(0,0,0,H);
      grad.addColorStop(0, 'rgba(255,255,255,0.05)');
      grad.addColorStop(1, 'rgba(255,255,255,0.02)');
      ctx.fillStyle = grad; ctx.fillRect(0,0,W,H);
      const maxV = Math.max(...values) || 1;
      const areaW = W - padL - padR;
      const areaH = H - padT - padB;
      const stepX = areaW / values.length;
      ctx.strokeStyle = 'rgba(255,255,255,0.15)'; ctx.lineWidth = 1; ctx.beginPath();
      ctx.moveTo(padL, padT); ctx.lineTo(padL, padT + areaH); ctx.lineTo(padL + areaW, padT + areaH); ctx.stroke();
      const barW = Math.min(48, stepX * 0.6);
      values.forEach((v, i) => {
        const x = padL + i*stepX + (stepX - barW)/2;
        const h = (v/maxV) * (areaH * 0.9);
        const y = padT + areaH - h;
        const g = ctx.createLinearGradient(0,y,0,y+h);
        g.addColorStop(0, '#22d3ee'); g.addColorStop(1, '#f59e0b');
        ctx.fillStyle = g; roundRect(ctx, x, y, barW, h, 8); ctx.fill();
        ctx.fillStyle = 'rgba(226,232,240,0.9)'; ctx.font = 'bold 12px ui-sans-serif, system-ui'; ctx.textAlign = 'center'; ctx.fillText(v + '%', x + barW/2, y - 6);
        ctx.fillStyle = 'rgba(148,163,184,0.95)'; ctx.font = '11px ui-sans-serif, system-ui'; wrapText(ctx, labels[i], x + barW/2, padT + areaH + 14, Math.max(barW+14, 70));
      });
    }
    function roundRect(ctx, x, y, w, h, r){ const rr = Math.min(r, w/2, h/2); ctx.beginPath(); ctx.moveTo(x+rr, y); ctx.arcTo(x+w, y, x+w, y+h, rr); ctx.arcTo(x+w, y+h, x, y+h, rr); ctx.arcTo(x, y+h, x, y, rr); ctx.arcTo(x, y, x+w, y, rr); ctx.closePath(); }
    function wrapText(ctx, text, x, y, maxW){ const words = String(text).split(' '); let line = '', lines = [], t = ''; for (const w of words){ t = (line ? line + ' ' : '') + w; if (ctx.measureText(t).width > maxW){ lines.push(line); line = w; } else line = t; } lines.push(line); const lh = 12; lines.forEach((ln, i) => ctx.fillText(ln, x, y + i*lh)); }

    // Inicialização
    buildGallery();
    // Inicia com o primeiro vídeo após um breve delay
    setTimeout(() => selectVideo(0), 500);
  </script>
</body>
</html>